<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CT2 Rechenhilfe - Timer/Counter & UART Helper</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>CT2 Rechenhilfe</h1>
            <p>CT2 ZHAW TZ22 Hilfsmittel</p>
        </header>

        <nav class="calculator-nav">
            <!-- Timer/Counter Gruppe -->
            <div class="nav-group">
                <div class="nav-group-title">‚è±Ô∏è Timer/Counter</div>
                <button class="nav-btn active" data-calculator="timer-theory">Timer Theorie</button>
                <button class="nav-btn" data-calculator="prescaler">Prescaler & ARR</button>
                <button class="nav-btn" data-calculator="timer-solver">Counter Problem</button>
                <button class="nav-btn" data-calculator="timer-pwm">Timer PWM</button>
                <button class="nav-btn" data-calculator="pwm">PWM Werte</button>
            </div>
            
            <!-- ADC Gruppe -->
            <div class="nav-group">
                <div class="nav-group-title">üìä ADC</div>
                <button class="nav-btn" data-calculator="adc">ADC Rechner</button>
                <button class="nav-btn" data-calculator="adc-offset">ADC Offset</button>
                <button class="nav-btn" data-calculator="adc-optimal">Optimale ADC</button>
            </div>
            
            <!-- UART Gruppe -->
            <div class="nav-group">
                <div class="nav-group-title">üì° UART</div>
                <button class="nav-btn" data-calculator="uart">UART Parameter</button>
                <button class="nav-btn" data-calculator="uart-timing">UART Timing</button>
                <button class="nav-btn" data-calculator="uart-optimal">Optimale UART</button>
            </div>
            
            <!-- Hardware Gruppe -->
            <div class="nav-group">
                <div class="nav-group-title">üîß Hardware</div>
                <button class="nav-btn" data-calculator="gpio">GPIO Konfiguration</button>
                <button class="nav-btn" data-calculator="address-decoder">Adressdekodierung</button>
                <button class="nav-btn" data-calculator="memory">Memory Rechner</button>
                <button class="nav-btn" data-calculator="interrupt">Interrupt Impact</button>
                <button class="nav-btn" data-calculator="endian">Endianness</button>
            </div>
        </nav>

        <!-- Prescaler Calculator -->
        <div id="prescaler-calculator" class="calculator active">
            <h2>Prescaler und ARR Werte berechnen</h2>
            <div class="input-group">
                <label for="clock-freq">Clock Frequenz (Hz):</label>
                <input type="number" id="clock-freq" placeholder="z.B. 72000000">
            </div>
            <div class="input-group">
                <label for="target-time">Gew√ºnschtes Zeitintervall (Sekunden):</label>
                <input type="number" id="target-time" step="any" placeholder="z.B. 0.001">
            </div>
            <div class="input-group">
                <label for="timer-bits">Timer Aufl√∂sung (Bits):</label>
                <select id="timer-bits">
                    <option value="16">16-bit</option>
                    <option value="32">32-bit</option>
                </select>
            </div>
            <div class="input-group">
                <label for="fixed-prescaler">Fester Prescaler (optional):</label>
                <input type="number" id="fixed-prescaler" placeholder="Leer lassen f√ºr automatische Suche">
            </div>
            <button onclick="calculatePrescaler()" class="calc-btn">Berechnen</button>
            <div id="prescaler-result" class="result"></div>
        </div>

        <!-- PWM Calculator -->
        <div id="pwm-calculator" class="calculator">
            <h2>PWM Duty Cycle Werte berechnen</h2>
            <div class="input-group">
                <label for="arr-value">ARR Wert:</label>
                <input type="number" id="arr-value" placeholder="Optional">
            </div>
            <div class="input-group">
                <label for="duty-cycle">Duty Cycle (%):</label>
                <input type="number" id="duty-cycle" step="any" placeholder="Optional">
            </div>
            <div class="input-group">
                <label for="ccr-value">CCR Wert:</label>
                <input type="number" id="ccr-value" placeholder="Optional">
            </div>
            <div class="input-group">
                <label for="pwm-clock-freq">Clock Frequenz (Hz, optional):</label>
                <input type="number" id="pwm-clock-freq" placeholder="F√ºr Periodenberechnung">
            </div>
            <div class="input-group">
                <label for="pwm-prescaler">Prescaler (optional):</label>
                <input type="number" id="pwm-prescaler" placeholder="F√ºr Periodenberechnung">
            </div>
            <button onclick="calculatePWM()" class="calc-btn">Berechnen</button>
            <div id="pwm-result" class="result"></div>
        </div>

        <!-- ADC Calculator -->
        <div id="adc-calculator" class="calculator">
            <h2>ADC Aufl√∂sung und Werte berechnen</h2>
            <div class="input-group">
                <label for="adc-bits">ADC Aufl√∂sung (Bits):</label>
                <input type="number" id="adc-bits" min="1" max="32" placeholder="z.B. 12">
            </div>
            <div class="input-group">
                <label for="vref-mv">Referenzspannung (mV):</label>
                <input type="number" id="vref-mv" placeholder="z.B. 3300">
            </div>
            <div class="input-group">
                <label for="digital-value">Digitaler Wert (optional):</label>
                <input type="number" id="digital-value" placeholder="Zum Umwandeln in Spannung">
            </div>
            <div class="input-group">
                <label for="input-voltage">Eingangsspannung (mV, optional):</label>
                <input type="number" id="input-voltage" placeholder="Zum Umwandeln in Digital">
            </div>
            <div class="input-group">
                <label for="actual-max-voltage">Tats√§chliche Spannung bei Max-Code (mV, optional):</label>
                <input type="number" id="actual-max-voltage" placeholder="F√ºr Gain Error Berechnung">
            </div>
            <button onclick="calculateADC()" class="calc-btn">Berechnen</button>
            <div id="adc-result" class="result"></div>
        </div>

        <!-- ADC Offset Calculator -->
        <div id="adc-offset-calculator" class="calculator">
            <h2>ADC Offset Fehler berechnen</h2>
            <div class="input-group">
                <label for="offset-adc-bits">ADC Aufl√∂sung (Bits):</label>
                <input type="number" id="offset-adc-bits" min="1" max="32" placeholder="z.B. 12">
            </div>
            <div class="input-group">
                <label for="offset-vref-mv">Referenzspannung (mV):</label>
                <input type="number" id="offset-vref-mv" placeholder="z.B. 3300">
            </div>
            <div class="input-group">
                <label for="ideal-digital">Idealer Digitalwert (optional):</label>
                <input type="number" id="ideal-digital" placeholder="Erwarteter Wert">
            </div>
            <div class="input-group">
                <label for="measured-digital">Gemessener Digitalwert (optional):</label>
                <input type="number" id="measured-digital" placeholder="Tats√§chlicher Wert">
            </div>
            <div class="input-group">
                <label for="offset-input-voltage">Bekannte Eingangsspannung (mV, optional):</label>
                <input type="number" id="offset-input-voltage" placeholder="F√ºr Offset-Berechnung">
            </div>
            <div class="input-group">
                <label for="offset-lsb">Bekannter Offset (LSB, optional):</label>
                <input type="number" id="offset-lsb" step="any" placeholder="F√ºr Korrektur">
            </div>
            <button onclick="calculateADCOffset()" class="calc-btn">Berechnen</button>
            <div id="adc-offset-result" class="result"></div>
        </div>

        <!-- Optimal ADC Calculator -->
        <div id="adc-optimal-calculator" class="calculator">
            <h2>Optimale ADC Aufl√∂sung finden</h2>
            <div class="input-group">
                <label for="optimal-vref-mv">Referenzspannung (mV):</label>
                <input type="number" id="optimal-vref-mv" placeholder="z.B. 3300">
            </div>
            <div class="input-group">
                <label for="target-lsb">Ziel LSB Wert (mV):</label>
                <input type="number" id="target-lsb" step="any" placeholder="z.B. 1.0">
            </div>
            <button onclick="findOptimalADC()" class="calc-btn">Berechnen</button>
            <div id="adc-optimal-result" class="result"></div>
        </div>

        <!-- Timer Solver -->
        <div id="timer-solver-calculator" class="calculator">
            <h2>Timer/Counter Problem l√∂sen</h2>
            <div class="input-group">
                <label for="solver-timer-bits">Timer Aufl√∂sung (Bits):</label>
                <select id="solver-timer-bits">
                    <option value="16">16-bit</option>
                    <option value="32">32-bit</option>
                </select>
            </div>
            <div class="input-group">
                <label for="current-cnt">Aktueller CNT Wert:</label>
                <input type="number" id="current-cnt" placeholder="z.B. 1000">
            </div>
            <div class="input-group">
                <label for="solver-ccr-value">CCR Wert:</label>
                <input type="number" id="solver-ccr-value" placeholder="z.B. 2000">
            </div>
            <div class="input-group">
                <label for="solver-prescaler">Prescaler (jeder N-te Zyklus):</label>
                <input type="number" id="solver-prescaler" placeholder="z.B. 8">
            </div>
            <div class="input-group">
                <label for="count-direction">Z√§hlrichtung:</label>
                <select id="count-direction">
                    <option value="up">Up</option>
                    <option value="down">Down</option>
                </select>
            </div>
            <div class="input-group">
                <label for="solver-arr-value">ARR Wert (optional):</label>
                <input type="number" id="solver-arr-value" placeholder="Leer f√ºr Maximum">
            </div>
            <button onclick="solveTimerProblem()" class="calc-btn">Berechnen</button>
            <div id="timer-solver-result" class="result"></div>
        </div>

        <!-- Endianness Converter -->
        <div id="endian-calculator" class="calculator">
            <h2>Endianness Konverter</h2>
            <div class="input-group">
                <label for="hex-data">Hex Daten:</label>
                <input type="text" id="hex-data" placeholder="z.B. 0x1234ABCD oder 1234ABCD">
            </div>
            <div class="input-group">
                <label for="target-endian">Ziel Endianness:</label>
                <select id="target-endian">
                    <option value="little">Little Endian</option>
                    <option value="big">Big Endian</option>
                </select>
            </div>
            <div class="input-group">
                <label for="data-width">Datenbreite (Bits, optional):</label>
                <input type="number" id="data-width" placeholder="z.B. 32">
            </div>
            <button onclick="convertEndianness()" class="calc-btn">Konvertieren</button>
            <div id="endian-result" class="result"></div>
        </div>

        <!-- Complete Timer PWM -->
        <div id="timer-pwm-calculator" class="calculator">
            <h2>Kompletter Timer PWM Problem Solver</h2>
            <div class="input-group">
                <label for="complete-clock-freq">Clock Frequenz (Hz):</label>
                <input type="number" id="complete-clock-freq" placeholder="z.B. 72000000">
            </div>
            <div class="input-group">
                <label for="complete-prescaler">Prescaler Wert:</label>
                <input type="number" id="complete-prescaler" placeholder="z.B. 8">
            </div>
            <div class="input-group">
                <label for="period-ms">Gew√ºnschte Periode (ms):</label>
                <input type="number" id="period-ms" step="any" placeholder="z.B. 1.0">
            </div>
            <div class="input-group">
                <label for="duty-fraction">Duty Cycle (Bruch oder Prozent):</label>
                <input type="text" id="duty-fraction" placeholder="z.B. 7/8 oder 87.5 oder 87.5%">
            </div>
            <div class="input-group">
                <label for="complete-timer-bits">Timer Bits:</label>
                <select id="complete-timer-bits">
                    <option value="16" selected>16-bit</option>
                    <option value="32">32-bit</option>
                </select>
            </div>
            <div class="input-group">
                <label for="complete-count-dir">Z√§hlrichtung:</label>
                <select id="complete-count-dir">
                    <option value="down" selected>Down</option>
                    <option value="up">Up</option>
                </select>
            </div>
            <button onclick="solveCompleteTimerPWM()" class="calc-btn">Berechnen</button>
            <div id="timer-pwm-result" class="result"></div>
        </div>

        <!-- UART Parameters -->
        <div id="uart-calculator" class="calculator">
            <h2>UART Parameter berechnen</h2>
            <div class="input-group">
                <label for="uart-data-bits">Datenbits:</label>
                <select id="uart-data-bits">
                    <option value="8" selected>8</option>
                    <option value="7">7</option>
                    <option value="9">9</option>
                </select>
            </div>
            <div class="input-group">
                <label for="uart-stop-bits">Stoppbits:</label>
                <select id="uart-stop-bits">
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                </select>
            </div>
            <div class="input-group">
                <label for="uart-parity">Parit√§t:</label>
                <select id="uart-parity">
                    <option value="none" selected>Keine</option>
                    <option value="even">Even</option>
                    <option value="odd">Odd</option>
                </select>
            </div>
            <div class="input-group">
                <label for="uart-baud-rate">Baud Rate (optional):</label>
                <input type="number" id="uart-baud-rate" placeholder="z.B. 9600">
            </div>
            <div class="input-group">
                <label for="uart-byte-rate">Byte Rate (Bytes/s, optional):</label>
                <input type="number" id="uart-byte-rate" placeholder="z.B. 1000">
            </div>
            <div class="input-group">
                <label for="uart-overhead">Sync Overhead Verh√§ltnis (optional):</label>
                <input type="number" id="uart-overhead" step="any" placeholder="z.B. 0.1 f√ºr 10%">
            </div>
            <button onclick="calculateUARTParams()" class="calc-btn">Berechnen</button>
            <div id="uart-result" class="result"></div>
        </div>

        <!-- UART Timing -->
        <div id="uart-timing-calculator" class="calculator">
            <h2>UART √úbertragungszeit berechnen</h2>
            <div class="input-group">
                <label for="timing-baud-rate">Baud Rate:</label>
                <input type="number" id="timing-baud-rate" placeholder="z.B. 9600">
            </div>
            <div class="input-group">
                <label for="data-length-bytes">Anzahl Bytes zu √ºbertragen:</label>
                <input type="number" id="data-length-bytes" placeholder="z.B. 100">
            </div>
            <div class="input-group">
                <label for="timing-data-bits">Datenbits:</label>
                <select id="timing-data-bits">
                    <option value="8" selected>8</option>
                    <option value="7">7</option>
                    <option value="9">9</option>
                </select>
            </div>
            <div class="input-group">
                <label for="timing-stop-bits">Stoppbits:</label>
                <select id="timing-stop-bits">
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                </select>
            </div>
            <div class="input-group">
                <label for="timing-parity">Parit√§t:</label>
                <select id="timing-parity">
                    <option value="none" selected>Keine</option>
                    <option value="even">Even</option>
                    <option value="odd">Odd</option>
                </select>
            </div>
            <button onclick="calculateUARTTiming()" class="calc-btn">Berechnen</button>
            <div id="uart-timing-result" class="result"></div>
        </div>

        <!-- Optimal UART -->
        <div id="uart-optimal-calculator" class="calculator">
            <h2>Optimale UART Baud Rate finden</h2>
            <div class="input-group">
                <label for="target-byte-rate">Ziel Byte Rate (Bytes/s):</label>
                <input type="number" id="target-byte-rate" placeholder="z.B. 1000">
            </div>
            <div class="input-group">
                <label for="optimal-data-bits">Datenbits:</label>
                <select id="optimal-data-bits">
                    <option value="8" selected>8</option>
                    <option value="7">7</option>
                    <option value="9">9</option>
                </select>
            </div>
            <div class="input-group">
                <label for="optimal-stop-bits">Stoppbits:</label>
                <select id="optimal-stop-bits">
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                </select>
            </div>
            <div class="input-group">
                <label for="optimal-parity">Parit√§t:</label>
                <select id="optimal-parity">
                    <option value="none" selected>Keine</option>
                    <option value="even">Even</option>
                    <option value="odd">Odd</option>
                </select>
            </div>
            <div class="input-group">
                <label for="max-error-percent">Max. Fehler (%):</label>
                <input type="number" id="max-error-percent" value="5" step="any" placeholder="z.B. 5">
            </div>
            <button onclick="findOptimalBaudRate()" class="calc-btn">Berechnen</button>
            <div id="uart-optimal-result" class="result"></div>
        </div>

        <!-- GPIO Configuration Calculator -->
        <div id="gpio-calculator" class="calculator">
            <h2>GPIO Konfiguration berechnen</h2>
            <div class="input-group">
                <label for="gpio-port">GPIO Port:</label>
                <select id="gpio-port">
                    <option value="A">Port A</option>
                    <option value="B">Port B</option>
                    <option value="C">Port C</option>
                    <option value="D">Port D</option>
                    <option value="E">Port E</option>
                    <option value="F">Port F</option>
                    <option value="G">Port G</option>
                    <option value="H">Port H</option>
                    <option value="I">Port I</option>
                    <option value="J">Port J</option>
                    <option value="K">Port K</option>
                </select>
            </div>
            <div class="input-group">
                <label for="gpio-pin">Pin Nummer (0-15):</label>
                <input type="number" id="gpio-pin" min="0" max="15" placeholder="z.B. 5">
            </div>
            <div class="input-group">
                <label for="gpio-mode">GPIO Mode:</label>
                <select id="gpio-mode">
                    <option value="input">Input</option>
                    <option value="output">Output</option>
                    <option value="alternate">Alternate Function</option>
                    <option value="analog">Analog</option>
                </select>
            </div>
            <div class="input-group">
                <label for="gpio-output-type">Output Type (nur f√ºr Output):</label>
                <select id="gpio-output-type">
                    <option value="">-- Nicht verwendet --</option>
                    <option value="push-pull">Push-Pull</option>
                    <option value="open-drain">Open-Drain</option>
                </select>
            </div>
            <div class="input-group">
                <label for="gpio-pull">Pull-up/Pull-down:</label>
                <select id="gpio-pull">
                    <option value="none">Keine</option>
                    <option value="pull-up">Pull-up</option>
                    <option value="pull-down">Pull-down</option>
                </select>
            </div>
            <div class="input-group">
                <label for="gpio-speed">Output Speed (nur f√ºr Output):</label>
                <select id="gpio-speed">
                    <option value="">-- Nicht verwendet --</option>
                    <option value="low">Low Speed</option>
                    <option value="medium">Medium Speed</option>
                    <option value="fast">Fast Speed</option>
                    <option value="high">High Speed</option>
                </select>
            </div>
            <button onclick="calculateGPIO()" class="calc-btn">Konfiguration berechnen</button>
            
            <!-- GPIO Pull-up/Pull-down Entscheidungshilfe -->
            <div class="theory-section" style="margin-top: 20px;">
                <h3>üîß Pull-up/Pull-down Entscheidungshilfe</h3>
                <div class="theory-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="example-box">
                            <p><strong>‚úÖ Pull-up verwenden bei:</strong></p>
                            <ul style="margin: 8px 0; padding-left: 15px;">
                                <li>Input Pins mit Schaltern/Tasten</li>
                                <li>Open-Drain Outputs</li>
                                <li>I¬≤C/SMBus Leitungen</li>
                                <li>Reset-Leitungen (aktiv LOW)</li>
                                <li><strong>Standard wenn unklar</strong></li>
                            </ul>
                        </div>
                        <div class="example-box">
                            <p><strong>‚¨áÔ∏è Pull-down verwenden bei:</strong></p>
                            <ul style="margin: 8px 0; padding-left: 15px;">
                                <li>Inputs normalerweise LOW</li>
                                <li>Sensor-Eing√§nge (positive Signale)</li>
                                <li>Enable-Signale (normalerweise disabled)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="example-box" style="background: rgba(231, 76, 60, 0.1); border-color: #e74c3c;">
                        <p><strong>‚ùå Keine Pull-Widerst√§nde bei:</strong></p>
                        <ul style="margin: 8px 0; padding-left: 15px;">
                            <li><strong>Analog Inputs</strong> (verf√§lschen Messung)</li>
                            <li><strong>Push-Pull Outputs</strong> (treiben aktiv HIGH/LOW)</li>
                            <li><strong>High-Speed Digital</strong> (beeinflussen Timing)</li>
                            <li>Externe Pull-Widerst√§nde vorhanden</li>
                        </ul>
                    </div>
                    <p><strong>üí° CT2 Faustregel:</strong> Wenn nicht spezifiziert ‚Üí <strong>Pull-up w√§hlen</strong> (sicherster Default)</p>
                </div>
            </div>
            
            <div id="gpio-result" class="result"></div>
        </div>

        <!-- Address Decoding Calculator -->
        <div id="address-decoder-calculator" class="calculator">
            <h2>Adressdekodierung berechnen</h2>
            <div class="input-group">
                <label for="address-lines">Adressleitungen:</label>
                <input type="text" id="address-lines" placeholder="z.B. A[5:0] oder 6">
            </div>
            <div class="input-group">
                <label for="control-register-bits">Control Register Adressbits (optional):</label>
                <input type="number" id="control-register-bits" min="1" max="16" placeholder="z.B. 4 f√ºr 4 Adressen">
            </div>
            <div class="input-group">
                <label for="data-bus-width">Datenbusbreite (Bits):</label>
                <input type="number" id="data-bus-width" min="1" max="64" value="8" placeholder="z.B. 8">
            </div>
            <div class="input-group">
                <label for="base-address">Basisadresse (Hex, optional):</label>
                <input type="text" id="base-address" placeholder="z.B. 0x1000 oder leer f√ºr 0x0000">
            </div>
            <div class="input-group">
                <label for="select-pattern">Select-Signal Muster (optional):</label>
                <input type="text" id="select-pattern" placeholder="z.B. A[5]&A[4]&!A[3]&A[2] f√ºr spezifische Dekodierung">
            </div>
            <div class="input-group">
                <label for="target-address">Zieladresse f√ºr Dekodierung (Hex, optional):</label>
                <input type="text" id="target-address" placeholder="z.B. 0x28 f√ºr Reverse-Engineering">
            </div>
            <button onclick="calculateAddressDecoding()" class="calc-btn">Adressdekodierung berechnen</button>
            <div id="address-decoder-result" class="result"></div>
        </div>

        <!-- Memory Calculator -->
        <div id="memory-calculator" class="calculator">
            <h2>Memory Rechner</h2>
            <div class="input-group">
                <label for="memory-mode">Berechnungsmodus:</label>
                <select id="memory-mode">
                    <option value="address-to-size">Adresspins ‚Üí Speichergr√∂sse</option>
                    <option value="size-to-address">Speichergr√∂sse ‚Üí Adresspins</option>
                    <option value="memory-mapping">Memory Mapping</option>
                    <option value="address-range">Adressbereich berechnen</option>
                </select>
            </div>
            
            <!-- Adresspins ‚Üí Speichergr√∂sse -->
            <div id="address-to-size-inputs" class="mode-inputs">
                <div class="input-group">
                    <label for="address-pins">Anzahl Adresspins:</label>
                    <input type="number" id="address-pins" min="1" max="64" placeholder="z.B. 16">
                </div>
                <div class="input-group">
                    <label for="data-width">Datenbreite (Bits):</label>
                    <input type="number" id="data-width-mem" value="8" placeholder="z.B. 8">
                </div>
            </div>
            
            <!-- Speichergr√∂sse ‚Üí Adresspins -->
            <div id="size-to-address-inputs" class="mode-inputs" style="display: none;">
                <div class="input-group">
                    <label for="memory-size">Speichergr√∂sse:</label>
                    <input type="number" id="memory-size" placeholder="z.B. 64">
                </div>
                <div class="input-group">
                    <label for="size-unit">Einheit:</label>
                    <select id="size-unit">
                        <option value="B">Bytes</option>
                        <option value="KB">KB (1024 Bytes)</option>
                        <option value="MB">MB (1024 KB)</option>
                        <option value="GB">GB (1024 MB)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="data-width-reverse">Datenbreite (Bits):</label>
                    <input type="number" id="data-width-reverse" value="8" placeholder="z.B. 8">
                </div>
            </div>
            
            <!-- Memory Mapping -->
            <div id="memory-mapping-inputs" class="mode-inputs" style="display: none;">
                <div class="input-group">
                    <label for="base-addr">Basisadresse (Hex):</label>
                    <input type="text" id="base-addr" placeholder="z.B. 0x6800">
                </div>
                <div class="input-group">
                    <label for="mem-size-mapping">Speichergr√∂sse:</label>
                    <input type="number" id="mem-size-mapping" placeholder="z.B. 64">
                </div>
                <div class="input-group">
                    <label for="mapping-unit">Einheit:</label>
                    <select id="mapping-unit">
                        <option value="B">Bytes</option>
                        <option value="KB" selected>KB</option>
                        <option value="MB">MB</option>
                    </select>
                </div>
            </div>
            
            <!-- Adressbereich -->
            <div id="address-range-inputs" class="mode-inputs" style="display: none;">
                <div class="input-group">
                    <label for="start-addr">Startadresse (Hex):</label>
                    <input type="text" id="start-addr" placeholder="z.B. 0x6800">
                </div>
                <div class="input-group">
                    <label for="end-addr">Endadresse (Hex):</label>
                    <input type="text" id="end-addr" placeholder="z.B. 0x6FFF">
                </div>
            </div>
            
            <button onclick="calculateMemory()" class="calc-btn">Berechnen</button>
            <div id="memory-result" class="result"></div>
        </div>

        <!-- Interrupt Impact Calculator -->
        <div id="interrupt-calculator" class="calculator">
            <h2>Interrupt Impact Calculator</h2>
            
            <div class="input-group">
                <label for="interrupt-mode">Berechnungsmodus:</label>
                <select id="interrupt-mode">
                    <option value="impact">System Impact berechnen</option>
                    <option value="optimal-buffer">Optimale Buffer-Gr√∂√üe finden</option>
                    <option value="max-datarate">Maximale Datenrate berechnen</option>
                    <option value="multiple-sources">Mehrere Interrupt-Quellen</option>
                </select>
            </div>
            
            <!-- System Impact Mode -->
            <div id="impact-inputs" class="mode-inputs">
                <div class="input-group">
                    <label for="cpu-freq">CPU Frequenz:</label>
                    <input type="number" id="cpu-freq" placeholder="z.B. 1000000">
                    <select id="cpu-freq-unit" style="width: auto; margin-left: 10px;">
                        <option value="Hz">Hz</option>
                        <option value="kHz">kHz</option>
                        <option value="MHz" selected>MHz</option>
                        <option value="GHz">GHz</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="data-rate">Datenrate:</label>
                    <input type="number" id="data-rate" placeholder="z.B. 16">
                    <select id="data-rate-unit" style="width: auto; margin-left: 10px;">
                        <option value="bit/s">bit/s</option>
                        <option value="kbit/s" selected>kbit/s</option>
                        <option value="Mbit/s">Mbit/s</option>
                        <option value="Byte/s">Byte/s</option>
                        <option value="kByte/s">kByte/s</option>
                        <option value="MByte/s">MByte/s</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="buffer-size">Buffer Gr√∂√üe:</label>
                    <input type="number" id="buffer-size" placeholder="z.B. 32">
                    <select id="buffer-size-unit" style="width: auto; margin-left: 10px;">
                        <option value="bit" selected>bit</option>
                        <option value="Byte">Byte</option>
                        <option value="word">word (16 bit)</option>
                        <option value="dword">dword (32 bit)</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="isr-time">ISR Execution Time:</label>
                    <input type="number" id="isr-time" placeholder="z.B. 100">
                    <select id="isr-time-unit" style="width: auto; margin-left: 10px;">
                        <option value="cycles" selected>CPU Zyklen</option>
                        <option value="us">Œºs</option>
                        <option value="ms">ms</option>
                        <option value="ns">ns</option>
                    </select>
                </div>
            </div>
            
            <!-- Optimal Buffer Mode -->
            <div id="optimal-buffer-inputs" class="mode-inputs" style="display: none;">
                <div class="input-group">
                    <label for="opt-cpu-freq">CPU Frequenz:</label>
                    <input type="number" id="opt-cpu-freq" placeholder="z.B. 1">
                    <select id="opt-cpu-freq-unit" style="width: auto; margin-left: 10px;">
                        <option value="MHz" selected>MHz</option>
                        <option value="Hz">Hz</option>
                        <option value="kHz">kHz</option>
                        <option value="GHz">GHz</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="opt-data-rate">Datenrate:</label>
                    <input type="number" id="opt-data-rate" placeholder="z.B. 16">
                    <select id="opt-data-rate-unit" style="width: auto; margin-left: 10px;">
                        <option value="kbit/s" selected>kbit/s</option>
                        <option value="bit/s">bit/s</option>
                        <option value="Mbit/s">Mbit/s</option>
                        <option value="kByte/s">kByte/s</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="opt-isr-time">ISR Execution Time:</label>
                    <input type="number" id="opt-isr-time" placeholder="z.B. 100">
                    <select id="opt-isr-time-unit" style="width: auto; margin-left: 10px;">
                        <option value="cycles" selected>CPU Zyklen</option>
                        <option value="us">Œºs</option>
                        <option value="ms">ms</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="target-impact">Ziel System Impact (%):</label>
                    <input type="number" id="target-impact" placeholder="z.B. 5" max="100" min="0.1" step="0.1">
                </div>
            </div>
            
            <!-- Max Datarate Mode -->
            <div id="max-datarate-inputs" class="mode-inputs" style="display: none;">
                <div class="input-group">
                    <label for="max-cpu-freq">CPU Frequenz:</label>
                    <input type="number" id="max-cpu-freq" placeholder="z.B. 1">
                    <select id="max-cpu-freq-unit" style="width: auto; margin-left: 10px;">
                        <option value="MHz" selected>MHz</option>
                        <option value="Hz">Hz</option>
                        <option value="kHz">kHz</option>
                        <option value="GHz">GHz</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="max-buffer-size">Buffer Gr√∂√üe:</label>
                    <input type="number" id="max-buffer-size" placeholder="z.B. 32">
                    <select id="max-buffer-size-unit" style="width: auto; margin-left: 10px;">
                        <option value="bit" selected>bit</option>
                        <option value="Byte">Byte</option>
                        <option value="word">word (16 bit)</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="max-isr-time">ISR Execution Time:</label>
                    <input type="number" id="max-isr-time" placeholder="z.B. 100">
                    <select id="max-isr-time-unit" style="width: auto; margin-left: 10px;">
                        <option value="cycles" selected>CPU Zyklen</option>
                        <option value="us">Œºs</option>
                        <option value="ms">ms</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="max-target-impact">Maximaler System Impact (%):</label>
                    <input type="number" id="max-target-impact" placeholder="z.B. 10" max="100" min="1" step="0.1">
                </div>
            </div>
            
            <button onclick="calculateInterrupt()" class="calc-btn">Berechnen</button>
            
            <!-- Interrupt Theory -->
            <div class="theory-section" style="margin-top: 20px;">
                <h3>‚ö° Interrupt Grundlagen</h3>
                <div class="theory-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="example-box">
                            <p><strong>üìä Grundformeln:</strong></p>
                            <ul style="margin: 8px 0; padding-left: 15px;">
                                <li><strong>Interrupt Freq:</strong> Datenrate √∑ Buffer Gr√∂√üe</li>
                                <li><strong>ISR Execution:</strong> ISR Zyklen √∑ CPU Freq</li>
                                <li><strong>System Impact:</strong> Int Freq √ó ISR Zeit √ó 100%</li>
                                <li><strong>Max Datenrate:</strong> bei 100% CPU Usage</li>
                            </ul>
                        </div>
                        <div class="example-box">
                            <p><strong>üéØ CT2 Beispiel:</strong></p>
                            <ul style="margin: 8px 0; padding-left: 15px;">
                                <li><strong>CPU:</strong> 1 MHz</li>
                                <li><strong>Datenrate:</strong> 16 kbit/s</li>
                                <li><strong>Buffer:</strong> 32 bit</li>
                                <li><strong>ISR:</strong> 100 Zyklen</li>
                                <li><strong>Impact:</strong> 5%</li>
                            </ul>
                        </div>
                    </div>
                    <div class="example-box">
                        <p><strong>üí° Optimierungsstrategien:</strong></p>
                        <p><strong>Buffer vergr√∂√üern:</strong> Weniger Interrupts bei gleicher Datenrate</p>
                        <p><strong>ISR optimieren:</strong> Weniger CPU-Zyklen pro Interrupt</p>
                        <p><strong>DMA verwenden:</strong> Hardware-basierte Daten√ºbertragung</p>
                        <p><strong>Interrupt Priorit√§ten:</strong> Wichtige Interrupts bevorzugen</p>
                    </div>
                </div>
            </div>
            
            <div id="interrupt-result" class="result"></div>
        </div>

        <!-- Timer Theory Reference -->
        <div id="timer-theory-calculator" class="calculator">
            <h2>Timer/Counter Theorie Nachschlagewerk</h2>
            
            <div class="theory-section">
                <h3>üîß Prescaler (Vorteiler)</h3>
                <div class="theory-content">
                    <p><strong>Funktion:</strong> Teilt die Eingangsfrequenz durch einen konfigurierbaren Wert.</p>
                    <p><strong>Zweck:</strong> Erm√∂glicht l√§ngere Zeitintervalle bei begrenzter Timer-Aufl√∂sung.</p>
                    <p><strong>Berechnung:</strong> f_count = f_clock / (Prescaler + 1)</p>
                    <p><strong>Register:</strong> Prescaler Register = Gew√ºnschter Teiler - 1</p>
                    <div class="example-box">
                        <p><strong>Beispiel:</strong> 84 MHz Clock, Prescaler = 8399<br>
                        ‚Üí f_count = 84 MHz / 8400 = 10 kHz<br>
                        ‚Üí 1 Timer-Tick = 100 Œºs</p>
                    </div>
                </div>
            </div>

            <div class="theory-section">
                <h3>üîÑ Counter (Z√§hler)</h3>
                <div class="theory-content">
                    <p><strong>Funktion:</strong> Z√§hlt Timer-Takte und speichert aktuellen Wert.</p>
                    <p><strong>Modi:</strong></p>
                    <ul>
                        <li><strong>Upcounter:</strong> Z√§hlt von 0 bis ARR, dann Reset auf 0</li>
                        <li><strong>Downcounter:</strong> Z√§hlt von ARR bis 0, dann Reload auf ARR</li>
                        <li><strong>Center-aligned:</strong> Z√§hlt 0‚ÜíARR‚Üí0 (f√ºr symmetrische PWM)</li>
                    </ul>
                    <div class="example-box">
                        <p><strong>Upcounter:</strong> 0 ‚Üí 1 ‚Üí 2 ‚Üí ... ‚Üí ARR ‚Üí 0 ‚Üí 1 ‚Üí ...<br>
                        <strong>Downcounter:</strong> ARR ‚Üí ARR-1 ‚Üí ... ‚Üí 1 ‚Üí 0 ‚Üí ARR ‚Üí ...</p>
                    </div>
                </div>
            </div>

            <div class="theory-section">
                <h3>üîÑ Reload/ARR Register</h3>
                <div class="theory-content">
                    <p><strong>Funktion:</strong> Bestimmt den Maximalwert des Counters.</p>
                    <p><strong>Upcounter:</strong> Counter z√§hlt von 0 bis ARR</p>
                    <p><strong>Downcounter:</strong> Counter wird bei Underflow auf ARR geladen</p>
                    <p><strong>Register:</strong> ARR Register = Gew√ºnschte Ticks - 1</p>
                    <p><strong>Periode:</strong> T = (ARR + 1) √ó Prescaler / f_clock</p>
                    <div class="example-box">
                        <p><strong>Beispiel:</strong> ARR = 9999, Prescaler = 8399, f_clock = 84 MHz<br>
                        ‚Üí Periode = 10000 √ó 8400 / 84MHz = 1 Sekunde</p>
                    </div>
                </div>
            </div>

            <div class="theory-section">
                <h3>üìä Capture Mode</h3>
                <div class="theory-content">
                    <p><strong>Funktion:</strong> Erfasst Counter-Wert bei externen Events (Flanken).</p>
                    <p><strong>Trigger:</strong> Steigende/fallende Flanke oder beide</p>
                    <p><strong>Anwendung:</strong> Frequenzmessung, Pulsl√§ngenmessung, Event-Timestamps</p>
                    <p><strong>Register:</strong> CCR enth√§lt den gefangenen Counter-Wert</p>
                    <div class="example-box">
                        <p><strong>Frequenzmessung:</strong><br>
                        Event 1: CCR1 = 1000<br>
                        Event 2: CCR2 = 3000<br>
                        ‚Üí Pulsl√§nge = (3000-1000) Timer-Ticks</p>
                    </div>
                </div>
            </div>

            <div class="theory-section">
                <h3>‚ö° Compare Mode</h3>
                <div class="theory-content">
                    <p><strong>Funktion:</strong> L√∂st Event aus wenn Counter = CCR Wert</p>
                    <p><strong>Aktionen:</strong> Interrupt, Output Toggle, PWM-Signal</p>
                    <p><strong>Anwendung:</strong> Zeitgesteuerte Events, PWM-Generierung</p>
                    <div class="example-box">
                        <p><strong>Compare Event:</strong><br>
                        CCR = 2500, ARR = 9999<br>
                        ‚Üí Event bei 25% der Periode<br>
                        ‚Üí Interrupt oder Output-√Ñnderung</p>
                    </div>
                </div>
            </div>

            <div class="theory-section">
                <h3>üåä PWM Mode</h3>
                <div class="theory-content">
                    <p><strong>PWM Mode 1 (Upcounter):</strong></p>
                    <ul>
                        <li>High wenn Counter < CCR</li>
                        <li>Low wenn Counter ‚â• CCR</li>
                        <li>Duty Cycle = CCR / (ARR + 1)</li>
                    </ul>
                    <p><strong>PWM Mode 2 (Downcounter):</strong></p>
                    <ul>
                        <li>High wenn Counter ‚â• CCR</li>
                        <li>Low wenn Counter < CCR</li>
                        <li>Duty Cycle = (ARR - CCR + 1) / (ARR + 1)</li>
                    </ul>
                    <div class="example-box">
                        <p><strong>25% Duty Cycle:</strong><br>
                        <strong>Mode 1:</strong> CCR = ARR √ó 0.25<br>
                        <strong>Mode 2:</strong> CCR = ARR √ó 0.75</p>
                    </div>
                </div>
            </div>

            <div class="theory-section">
                <h3>üìà Timing Beziehungen</h3>
                <div class="theory-content">
                    <p><strong>Grundformeln:</strong></p>
                    <ul>
                        <li><strong>Timer Frequenz:</strong> f_timer = f_clock / (Prescaler + 1)</li>
                        <li><strong>Timer Periode:</strong> T_timer = 1 / f_timer</li>
                        <li><strong>Overflow Periode:</strong> T_overflow = (ARR + 1) √ó T_timer</li>
                        <li><strong>PWM Frequenz:</strong> f_PWM = f_timer / (ARR + 1)</li>
                        <li><strong>PWM Periode:</strong> T_PWM = (ARR + 1) √ó T_timer</li>
                    </ul>
                    <div class="example-box">
                        <p><strong>Vollst√§ndiges Beispiel:</strong><br>
                        f_clock = 84 MHz, Prescaler = 83, ARR = 999<br>
                        ‚Üí f_timer = 84MHz/84 = 1 MHz<br>
                        ‚Üí f_PWM = 1MHz/1000 = 1 kHz<br>
                        ‚Üí T_PWM = 1 ms</p>
                    </div>
                </div>
            </div>

            <div class="theory-section">
                <h3>üöÄ Praktische Tipps</h3>
                <div class="theory-content">
                    <ul>
                        <li><strong>Prescaler Wahl:</strong> Grosser Prescaler f√ºr lange Zeiten, kleiner f√ºr hohe Aufl√∂sung</li>
                        <li><strong>ARR Maximum:</strong> 16-bit Timer: 65535, 32-bit Timer: 4294967295</li>
                        <li><strong>PWM Aufl√∂sung:</strong> H√∂here ARR-Werte = feinere Duty Cycle Kontrolle</li>
                        <li><strong>Interrupt Load:</strong> Niedrige Timer-Frequenzen reduzieren CPU-Last</li>
                        <li><strong>Genauigkeit:</strong> H√∂here Timer-Frequenz = bessere Zeitaufl√∂sung</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>